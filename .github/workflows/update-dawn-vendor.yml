name: update-dawn-vendor
on:
  push:
    branches: [main]
  workflow_dispatch:
permissions:
  contents: write
jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
          ref: main
      - run: |
          git config user.name "codex-bot"
          git config user.email "codex-bot@poseima.com"
      - run: |
          git fetch origin dawn-vendor || {
            git checkout -b dawn-vendor
            git push origin dawn-vendor
            exit 0
          }
          git checkout dawn-vendor
          git merge main --no-edit \
            -m "vendor-sync: merge main $(date +%Y-%m-%d) ($(git rev-parse --short main))"
          git push origin dawn-vendor
